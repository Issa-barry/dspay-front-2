<div class="px-8 min-h-screen flex justify-center items-center bg-surface-50 dark:bg-surface-950">
    <div class="border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded-2xl py-12 px-6 md:px-16 z-10 w-full max-w-md">
        
        <!-- Toast pour les notifications -->
        <p-toast></p-toast>
        
        <div class="mb-8">
            <div class="text-surface-900 dark:text-surface-0 text-2xl font-bold mb-3">
                Vérification
            </div>
            <span class="text-surface-600 dark:text-surface-200 font-medium">
                Nous avons envoyé un code à votre email:
            </span>
            <div class="flex items-center mt-2">
                <i class="pi pi-envelope text-primary mr-2"></i>
                <span class="text-surface-900 dark:text-surface-0 font-bold">
                    {{ maskedEmail }}
                </span>
            </div>
        </div>

        <div class="flex flex-col">
            <!-- Code inputs -->
            <div class="flex justify-between w-full items-center mb-6 gap-3">
                <p-inputNumber 
                    #inputNumber
                    [(ngModel)]="code1"
                    inputStyleClass="text-center w-14 h-14 text-2xl font-bold" 
                    [useGrouping]="false"
                    [min]="0"
                    [max]="9"
                    (onInput)="focusOnNext(input2)">
                </p-inputNumber>

                <p-inputNumber 
                    #input2 
                    [(ngModel)]="code2"
                    inputStyleClass="text-center w-14 h-14 text-2xl font-bold" 
                    [useGrouping]="false"
                    [min]="0"
                    [max]="9"
                    (onInput)="focusOnNext(input3)">
                </p-inputNumber>

                <p-inputNumber 
                    #input3 
                    [(ngModel)]="code3"
                    inputStyleClass="text-center w-14 h-14 text-2xl font-bold" 
                    [useGrouping]="false"
                    [min]="0"
                    [max]="9"
                    (onInput)="focusOnNext(input4)">
                </p-inputNumber>

                <p-inputNumber 
                    #input4 
                    [(ngModel)]="code4"
                    inputStyleClass="text-center w-14 h-14 text-2xl font-bold" 
                    [useGrouping]="false"
                    [min]="0"
                    [max]="9">
                </p-inputNumber>
            </div>

            <!-- Loading indicator -->
            <div *ngIf="isVerifying" class="text-center mb-4">
                <div class="inline-flex items-center gap-2 text-primary">
                    <i class="pi pi-spin pi-spinner text-lg"></i>
                    <span class="text-sm font-medium">Vérification en cours...</span>
                </div>
            </div>

            <!-- Resend code -->
            <div class="text-center mb-6">
                <p class="text-sm text-muted-color mb-2">Vous n'avez pas reçu le code ?</p>
                
                <button
                    *ngIf="!canResend"
                    class="text-sm text-muted-color cursor-not-allowed"
                    disabled>
                    Renvoyer dans {{ formatCountdown() }}
                </button>
                
                <button
                    *ngIf="canResend"
                    (click)="resendCode()"
                    [disabled]="isResending"
                    class="text-sm text-primary font-semibold hover:underline transition-all disabled:opacity-50">
                    <span *ngIf="!isResending">Renvoyer le code</span>
                    <span *ngIf="isResending" class="inline-flex items-center gap-2">
                        <i class="pi pi-spin pi-spinner text-xs"></i>
                        Envoi en cours...
                    </span>
                </button>
            </div>

            <!-- Action buttons -->
            <div class="flex flex-wrap gap-3 justify-between">
                <button
                    pButton
                    pRipple
                    label="Vérifier"
                    class="flex-auto h-12"
                    [disabled]="!isCodeComplete() || isVerifying"
                    [loading]="isVerifying"
                    (click)="verify()">
                </button>
            </div>

            <!-- Cancel link -->
            <div class="text-center mt-4">
                <button
                    (click)="cancel()"
                    class="text-sm text-surface-600 dark:text-surface-400 hover:text-primary transition-colors">
                    Retour à l'inscription
                </button>
            </div>
        </div>

    </div>
</div>